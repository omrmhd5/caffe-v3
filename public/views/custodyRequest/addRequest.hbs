{{> header}}
{{> navbar/navbar}}

<div class="row">
  <div class="col d-flex justify-content-center">
    <div class="col-12 col-md-6">
      {{#if successMessage}}
      <div class="alert alert-success alert-dismissable">
        <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
        {{successMessage}}
      </div>
      {{/if}}
      {{#if errorMessage}}
      <div class="alert alert-danger alert-dismissable">
        <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
        {{errorMessage}}
      </div>
      {{/if}}
      <div>
        <div class="headerPage">
          <div class="Title">
            <h2 class="text-center">إضافة طلب جديد</h2>
          </div>
        </div>
        <div class="card-body p-0">
          <form id="createCustodyForm" method="POST" action="/custodyRequest/add">
            <div class="form-group" dir="rtl" id="custodyGroup">
              <div class="row">
                <div class="form-group col-md-6">
                  <label class="float-right">
                    <p class="select"> الصنف</p>
                  </label>
                  <select id="custodyID" class="form-control" name="custodyID" required>
                    <option class="form-control" value="" selected>اختار</option>
                    {{#each custodies}}
                    <option value="{{remainingCount}},{{_id}}">{{name}}</option>
                    {{/each}}
                  </select>
                  <input type="text" hidden value={{branch._id}} id="branchID" name="branchID">
                </div>
                <div class="form-group col-md-6">
                  <label class="float-right">
                    <p class="select"> العدد المتبقي</p>
                  </label>
                  <input type="number" class="form-control" id="remainingCount" name="remainingCount" disabled>
                </div>
              </div>
            </div>
            <div class="form-group" dir="rtl" id="countGroup">
              <div class="row">
                <div class="col">
                  <label class="float-right">
                    <p class="select">طلب صرف عدد</p>
                  </label>
                  <input type="number" class="form-control" id="spendCount" name="spendCount">
                </div>
                <div class="col">
                  <label class="float-right">
                    <p class="select">طلب إرجاع عدد</p>
                  </label>
                  <input type="number" class="form-control" id="returnCount" name="returnCount">
                </div>
              </div>
            </div>
            <div class="form-group" dir="rtl" id="reasonGroup">
              <div class="row">
                <div class="col">
                  <label class="float-right">
                    <p class="select"> سبب الصرف </p>
                  </label>
                  <input type="text" class="form-control" id="reason" name="reason">
                </div>
              </div>
            </div>
            <div class="modal-footer border-0 center Center row">
              <a href="/custodyRequest" class=" btnclass signature btn-round">
                <h6 class="select"> عودة إلى قائمة الطلبات </h6>
              </a>
              <button type="submit" class=" btnclass mx-auto mx-md-2">
                <h6 class="select"> أضف الطلب </h6>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
{{> footer}}
<script>
  document.querySelector('#custodyID').addEventListener('change', (event) => {
    let array = event.target.value.split(',');
    document.querySelector('#remainingCount').value = array[0];
  });

</script>
{{> footer/userFooter}}